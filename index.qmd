```{r echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.show = "hold",
  fig.align = "center",
  fig.width = 13.85,
  fig.height = 18.75,
  out.width = NULL
)
source("./R/generate_mandala.R")
source("./R/generate_sudoku.R")
source("./R/generate_wordfinder.R")
try({
  sysfonts::font_add_google("Dancing Script")
})
showtext::showtext_auto()
options(book.font.type = "Dancing Script")
wordlist <- readLines("https://www.mit.edu/~ecprice/wordlist.10000")
debug <- FALSE
```

::: {.content-visible when-format="html"}
Welcome to this generative puzzle book! Created using the open-source programming language R, this book is completely [free](https://www.gnu.org/philosophy/free-sw.html)! And here's the best part: it never runs out! If you're craving more puzzles, just come back tomorrow. This book refreshes itself every day, offering you 9 brand-new mandalas and 9 sudoku to enjoy.
:::

```{r echo = FALSE, message=FALSE}
mandalaseeds <- sample.int(.Machine$integer.max, 9)
names(mandalaseeds) <- 1:9
sudokuseeds <- sample.int(.Machine$integer.max, 18)
names(sudokuseeds) <- 1:18
wordfinderseeds <- sample.int(.Machine$integer.max, 18)
names(wordfinderseeds) <- 1:18
```

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output()) {
  seed <- mandalaseeds[1]
  set.seed(seed)
  p1 <- generate_mandala(labels = TRUE)
  set.seed(seed)
  p2 <- generate_mandala(colors = TRUE)
  gridExtra::grid.arrange(p2, p1, layout_matrix = matrix(c(
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 1, 1,
    NA, NA, NA, 1, 1
  ), byrow = TRUE, nrow = 5, ncol = 5), top = grid::textGrob("— Mandala —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output()) {
  set.seed(sudokuseeds[1])
  generate_sudoku(sudokuseeds[1])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output()) {
  set.seed(wordfinderseeds[1])
  generate_wordfinder(wordfinderseeds[1], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[2])
  generate_sudoku(sudokuseeds[2])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[2])
  generate_wordfinder(wordfinderseeds[2], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  seed <- mandalaseeds[2]
  set.seed(seed)
  p1 <- generate_mandala(labels = TRUE)
  set.seed(seed)
  p2 <- generate_mandala(colors = TRUE)
  gridExtra::grid.arrange(p2, p1, layout_matrix = matrix(c(
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 1, 1,
    NA, NA, NA, 1, 1
  ), byrow = TRUE, nrow = 5, ncol = 5), top = grid::textGrob("— Mandala —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[3])
  generate_sudoku(sudokuseeds[3])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[3])
  generate_wordfinder(wordfinderseeds[3], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[4])
  generate_sudoku(sudokuseeds[4])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[4])
  generate_wordfinder(wordfinderseeds[4], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  seed <- mandalaseeds[3]
  set.seed(seed)
  p1 <- generate_mandala(labels = TRUE)
  set.seed(seed)
  p2 <- generate_mandala(colors = TRUE)
  gridExtra::grid.arrange(p2, p1, layout_matrix = matrix(c(
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 1, 1,
    NA, NA, NA, 1, 1
  ), byrow = TRUE, nrow = 5, ncol = 5), top = grid::textGrob("— Mandala —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[5])
  generate_sudoku(sudokuseeds[5])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[5])
  generate_wordfinder(wordfinderseeds[5], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[6])
  generate_sudoku(sudokuseeds[6])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[6])
  generate_wordfinder(wordfinderseeds[6], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  seed <- mandalaseeds[4]
  set.seed(seed)
  p1 <- generate_mandala(labels = TRUE)
  set.seed(seed)
  p2 <- generate_mandala(colors = TRUE)
  gridExtra::grid.arrange(p2, p1, layout_matrix = matrix(c(
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 1, 1,
    NA, NA, NA, 1, 1
  ), byrow = TRUE, nrow = 5, ncol = 5), top = grid::textGrob("— Mandala —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[7])
  generate_sudoku(sudokuseeds[7])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[7])
  generate_wordfinder(wordfinderseeds[7], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[8])
  generate_sudoku(sudokuseeds[8])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[8])
  generate_wordfinder(wordfinderseeds[8], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  seed <- mandalaseeds[5]
  set.seed(seed)
  p1 <- generate_mandala(labels = TRUE)
  set.seed(seed)
  p2 <- generate_mandala(colors = TRUE)
  gridExtra::grid.arrange(p2, p1, layout_matrix = matrix(c(
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 1, 1,
    NA, NA, NA, 1, 1
  ), byrow = TRUE, nrow = 5, ncol = 5), top = grid::textGrob("— Mandala —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[9])
  generate_sudoku(sudokuseeds[9])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[9])
  generate_wordfinder(wordfinderseeds[9], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[10])
  generate_sudoku(sudokuseeds[10])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[10])
  generate_wordfinder(wordfinderseeds[10], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  seed <- mandalaseeds[6]
  set.seed(seed)
  p1 <- generate_mandala(labels = TRUE)
  set.seed(seed)
  p2 <- generate_mandala(colors = TRUE)
  gridExtra::grid.arrange(p2, p1, layout_matrix = matrix(c(
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 1, 1,
    NA, NA, NA, 1, 1
  ), byrow = TRUE, nrow = 5, ncol = 5), top = grid::textGrob("— Mandala —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[11])
  generate_sudoku(sudokuseeds[11])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[11])
  generate_wordfinder(wordfinderseeds[11], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[12])
  generate_sudoku(sudokuseeds[12])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[12])
  generate_wordfinder(wordfinderseeds[12], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  seed <- mandalaseeds[7]
  set.seed(seed)
  p1 <- generate_mandala(labels = TRUE)
  set.seed(seed)
  p2 <- generate_mandala(colors = TRUE)
  gridExtra::grid.arrange(p2, p1, layout_matrix = matrix(c(
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 1, 1,
    NA, NA, NA, 1, 1
  ), byrow = TRUE, nrow = 5, ncol = 5), top = grid::textGrob("— Mandala —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[13])
  generate_sudoku(sudokuseeds[13])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[13])
  generate_wordfinder(wordfinderseeds[13], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[14])
  generate_sudoku(sudokuseeds[14])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[14])
  generate_wordfinder(wordfinderseeds[14], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  seed <- mandalaseeds[8]
  set.seed(seed)
  p1 <- generate_mandala(labels = TRUE)
  set.seed(seed)
  p2 <- generate_mandala(colors = TRUE)
  gridExtra::grid.arrange(p2, p1, layout_matrix = matrix(c(
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 1, 1,
    NA, NA, NA, 1, 1
  ), byrow = TRUE, nrow = 5, ncol = 5), top = grid::textGrob("— Mandala —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[15])
  generate_sudoku(sudokuseeds[15])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[15])
  generate_wordfinder(wordfinderseeds[15], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[16])
  generate_sudoku(sudokuseeds[16])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[16])
  generate_wordfinder(wordfinderseeds[16], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  seed <- mandalaseeds[9]
  set.seed(seed)
  p1 <- generate_mandala(labels = TRUE)
  set.seed(seed)
  p2 <- generate_mandala(colors = TRUE)
  gridExtra::grid.arrange(p2, p1, layout_matrix = matrix(c(
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 2, 2,
    2, 2, 2, 1, 1,
    NA, NA, NA, 1, 1
  ), byrow = TRUE, nrow = 5, ncol = 5), top = grid::textGrob("— Mandala —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[17])
  generate_sudoku(sudokuseeds[17])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[17])
  generate_wordfinder(wordfinderseeds[17], wordlist)
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(sudokuseeds[18])
  generate_sudoku(sudokuseeds[18])
}
```
\clearpage

```{r echo = FALSE, message=FALSE}
if (!knitr::is_html_output() && !debug) {
  set.seed(wordfinderseeds[18])
  generate_wordfinder(wordfinderseeds[18], wordlist)
}
```
\clearpage

<!-- Answers -->
```{r echo = FALSE, message=FALSE, fig.height = 16}
if (!knitr::is_html_output()) {
  plotList <- list()
  for (i in 1:9) {
    set.seed(sudokuseeds[i])
    plotList[[length(plotList) + 1]] <- generate_sudoku(sudokuseeds[i], solution = TRUE)
  }
  gridExtra::grid.arrange(grobs = plotList, layout_matrix = matrix(1:9, byrow = TRUE, nrow = 3, ncol = 3), top = grid::textGrob("— Sudoku ~ Solutions —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage

```{r echo = FALSE, message=FALSE, fig.height = 16}
if (!knitr::is_html_output()) {
  plotList <- list()
  for (i in 10:18) {
    set.seed(sudokuseeds[i])
    plotList[[length(plotList) + 1]] <- generate_sudoku(sudokuseeds[i], solution = TRUE)
  }
  gridExtra::grid.arrange(grobs = plotList, layout_matrix = matrix(1:9, byrow = TRUE, nrow = 3, ncol = 3), top = grid::textGrob("— Sudoku ~ Solutions —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage

```{r echo = FALSE, message=FALSE, fig.height = 16}
if (!knitr::is_html_output()) {
  plotList <- list()
  for (i in 1:9) {
    set.seed(wordfinderseeds[i])
    plotList[[length(plotList) + 1]] <- generate_wordfinder(wordfinderseeds[i], wordlist, solution = TRUE)
  }
  gridExtra::grid.arrange(grobs = plotList, layout_matrix = matrix(1:9, byrow = TRUE, nrow = 3, ncol = 3), top = grid::textGrob("— Word Finder ~ Solutions —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage

```{r echo = FALSE, message=FALSE, fig.height = 16}
if (!knitr::is_html_output()) {
  plotList <- list()
  for (i in 10:18) {
    set.seed(wordfinderseeds[i])
    plotList[[length(plotList) + 1]] <- generate_wordfinder(wordfinderseeds[i], wordlist, solution = TRUE)
  }
  gridExtra::grid.arrange(grobs = plotList, layout_matrix = matrix(1:9, byrow = TRUE, nrow = 3, ncol = 3), top = grid::textGrob("— Word Finder ~ Solutions —", gp = grid::gpar(fontsize = 75, fontfamily = getOption("book.font.type", "sans"), fontface = "bold")))
}
```
\clearpage
